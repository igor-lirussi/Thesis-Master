%----------------------------------------------------------------------------------------
\chapter{Introduction}
\label{chap:introduction}
%----------------------------------------------------------------------------------------

\section{Overview}
% Humans are good at VARIOUS tasks in different envs
Humans have a remarkable ability to achieve complex goals in a wide variety of tasks. A person is usually exposed to different scenarios during the day, starting from the home environment to the commute, work, mealtime, and so on. The versatility of our species is a key factor, and the human cognitive flexibility has been appointed as a major driver in evolution \cite{deak2003development}, \cite{karmiloff1994beyond}. Some situations are more complicated than others; nevertheless, regardless of their difference, humans excel in meeting the different demands to solve the tasks desired.

% env has sub-challenges and consequently sub-activities
All these scenarios present different small challenges to solve in order to accomplish the desired high-level goal. Humans switch contexts in a really flexible and natural way and constantly take care of the multitude of these small problems that are faced to complete the desired objective.
For example, a general task can be divided into subtasks, which can then be further divided into smaller ones \cite{kroemer2021review}.
The strategy of breaking down intricate objectives into smaller, manageable, simpler activities is the most widely used heuristic to solve problems \cite{egidi2006decomposition}.

% interactions involve OBJECTS
Many of these sub-challenges require an interaction with one or more objects. For example, the action of opening involves a door to pass through it while moving or to access the fridge for cooking. The reaching action can imply an object like a pen in the office to write or a glass of water to drink. To push as an action often implies a button to enable a device in the workplace, or to turn on a car to commute, or the stove to heat a meal. 
Objects have undoubtedly strong importance in the small actions performed to achieve a goal, and their affordance is still the object of research in humans \cite{maranesi2014cortical}, \cite{osiurak2017affordance} and machines \cite{horton2012affordances}.

% Humans ADAPT the actions learned to different environments
As seen, many different movements and sub-actions, often involving objects, are executed in daily life. Furthermore, they are also adapted to accomplish the current desired goals. The adaptation can involve a simple difference of position with respect to the previous location, both of the object or the executor, or can involve a completely different context to which the action learned is transferred. These skills are learned and discovered at the beginning, and then the knowledge of the action is abstracted and adapted to different purposes.  

% Humans COMBINE the actions together
Moreover, a person builds sequences of actions naturally to achieve the objective and, as discussed, adapts them to the environment. The skills are often combined together one after the other, based on the scenario but also based on the result and position of the previous execution.  Occasionally, it can happen that part of an action is used and part of another action, mixing previously learned movements if the situation requires it. This results in the creation of new combinations and compositions of previously known activities.    

% Humans also decide on what action to take midway
Lastly, dissecting complex challenges requires also decision-making under uncertainty, which is essential for achieving high-level goals since the sequence of activities is not always clear in advance. Often, the goal changes mid-way in response to the environment, or the initial assessment is sub-optimal or incorrect, forcing a change in planning and a new decision on what subsequent action to take. So it's worth noting that online decision under dynamic circumstances and change of skill executed allows a person to navigate the complexities of daily scenarios with success.

% Robots are not at this level
The human mind's capacity for abstraction, planning, and execution is still a remote objective for robotics \cite{konidaris2019necessity}. 
This level of adaptation to the environment and building of compounded behaviors is still a hard challenge to solve nowadays.

% Robots work in a controlled environment
For this reason, robots currently are not pervasive in society like other technologies. Humanoid robots have little if no presence and, despite the potential different uses, are relegated to mainly interaction and exhibition duties. The majority of robots work in a controlled environment, like factories, where the surroundings are specifically designed for them. The actions taken are repetitive, fixed, and in contact with a simple, defined set of objects.

% Robots are specialized
Furthermore, even if some robots are able to integrate into semi-structured environments (for example, the robotic vacuum cleaners for homes or lawnmowers for gardens), they are specialized to a single task in a single scenario. Multi-purpose robots require a more human-compatible design and a higher degree of intelligent behavior \cite{dechant2021toward}, but versatile humanoid robots are still not pervasive in the current status of society. 

% our proposal
In this study, we propose a computational model that is biologically inspired. Our approach consists in the use of mathematics and artificial intelligence to emulate human abstraction and adaptation capabilities in the execution of a series of primitive actions. 
We want to prove how demonstrating basic movements to a robot and composing them together with flexibility may lead to achieving complex tasks of various natures.
Specifically, movement primitives are reused and combined differently for different goals, avoiding explicit teaching of multiple objectives. The trajectories for the skills learned are adapted to the environment and partially composed thanks to the interpolation abilities of Conditional Neural Movement Primitives (CNMP) networks \cite{Ugur-RSS-19}.
Lastly, the approach has been implemented and tested on an anthropomorphic robot and on an industrial collaborative robot.



\section{Challenges}
% unstructured environment
Robotics dominates many fields, but as discussed, often the environment is controlled, designed to help the robot in its task, and not human-friendly. If the purpose is to integrate robots into the human environment, robots must adapt to humans, not vice-versa. All environments in which humans are present are not organized or predictable, and this means one issue is that robots have to accommodate for these conditions. A challenge is definitely to introduce the machine to an unstructured environment, and this implies many sub-issues. 

% perception
Having surroundings that might change forces the machines to have a great amount of perception. The system has to be extremely aware of the objects and people around it to operate in a safe and meaningful way. This translates into equipping many sensors and using real-time data from all available sources. Moreover, the machine cannot rely on these detection instruments mounted on the external world since a humanoid robot is expected to be mobile. Having a multi-purpose system that can act in different scenarios implies, indeed, a self-contained arrangement of sensors.

% create an environment digital-twin
The perception brings, in cascade, the necessity of storing this information and creating an internal copy of the surroundings that works as a base for planning and future predictions. Creating a digital twin for the environment is not essential for all the actions since some of them can be executed in real-time, but it is required to plan their effects and combine results together. For example, if a sponge is needed to clean a table, it would be faster to have the knowledge of its last position, but it can also be researched on demand and used while observing the effects in real-time till the table is clean. On the other hand, complex actions that combine multiple primitives need a future prediction of their effects on the environment, so its internal representation is required. 

% exploration
With changing surroundings, it is possible also that the expected position of objects is no longer consistent with the representation. This forces the system to find an alternative or explore the environment till the object is found. Other kinds of exploration possible are the exploration of the action space to infer new actions and results, or the exploration of objects' capabilities to learn new affordances and usages. \cite{Ahmetoglu_2022} 

% planning 
Another factor worth taking into consideration is the planning subject. Plans have to be structured in a meaningful way otherwise, an incorrect sequence won't just produce an incorrect result but might bring the system further away from the final goal. The combinations of actions generated usually have importance in the order of execution, so the product of the skills has to be considered carefully. 

% objects are designed for humans, have capabilities for humans, give meaning to the object 
Furthermore, objects and tools are usually designed for humans, so their capabilities might vary depending on the machine used and might influence the actions in the planning phase. Giving meanings to the objects, both in terms of affordances and representations, is still a tricky challenge in robotics \cite{7523298} and partially involves the previously investigated challenges of planning and exploration. 

% obstacle avoidance in movement execution
Also, obstacle avoidance, whenever there is an object in the trajectory of movement, is a factor to take into consideration. The robot is required to be aware of the surroundings and itself, not to collide, hurt, damage, or just fail the designated goal. Humans adapt previously known actions whenever an obstacle or an impediment is present. 

% how to adapt actions to positions or different contexts
Part of the adaptation challenge is also being able to transfer the skills known to new locations and scenarios. For example, learning how to turn a key for the door and use the action for the key of the car or the knob to turn on the stove. This is an essential capability that is difficult to implement in a machine.   

% how to merge actions
Another more hidden challenge is how the actions are merged among them. Usually, humans, when they pass from one action to another, apply a smooth transition. This means that the movements don't have to fully start and end as they are learned, or the result will be artificial and sub-optimal.   

% object handling depends on the object if it's not robots for interaction
Furthermore, object handling, grasping, and manipulation present some issues that are the object of research. How to pick the item desired, where,  with which grasp, and with which force intensity are issues that can undermine the final result.

% final state
Lastly, another challenge that will be encountered is the recognition when the action is completed. Being aware of the right final state is essential for successfully matching the expectations for the goal requested. 

These challenges discussed are crucial aspects to consider, but not all of them will be addressed in this project, and some will also be simplified. Nevertheless, it's worth noting the scope and limitations of this work and the boundaries within which the research operates.

\section{Objectives}
The aim of this research is to investigate novel skill generation by combining previously taught ones with the use of CNMPs \cite{Ugur-RSS-19}. 
The research aims to be applied to robotics scenarios involving trajectories for object manipulation and high-level goal achievement. 
The generation of new combinations of skills will be performed by connecting skill segments that the robot learned by demonstration. The amount of demonstrations given should be reasonable for the system to be applied in real life by a human. 
The combination of actions will be investigated in both the concatenation of trajectories end-to-end and the use of parts of them. 
The ultimate goal is to create a system that allows a robot, given some demonstrations, to reuse the skills acquired to complete different objectives whose trajectories were never taught explicitly. Furthermore, the adaptation should be acceptable in different configurations of the environment and, ideally in different scenarios.


\section{Thesis Structure} 
Accordingly, the remainder of this thesis is structured as follows.

% SoA
\Cref{chap:background} discusses the background of the topic, the current advancements in the field, and the related research with a literature review. 

% Platforms
In \cref{chap:platforms} the instruments and frameworks used in this research are listed and analyzed to be able to understand the initial setup and replicate the results. 

% Design
The \cref{chap:design} explains the design and architecture of the proposed method. In order to understand the logic, the conceptual passages and mathematical background. 

% Code Implementation
The \cref{chap:implementation} analyzes the key points of the implemented solution through the explanation of the most important passages in the code developed.

% Test and Validation
The \cref{chap:validation} shows the final results and the testing on real-life robotic platforms.

% Conclusions
Finally, \Cref{chap:conclusions} concludes this thesis by summarising its main contribution and future work.